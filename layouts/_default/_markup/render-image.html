{{- $img_destination := .Destination -}}
{{- if (and .Page.Site.Params.COSUrl.enable (not hugo.IsServer)) -}}
    {{ if not (hasPrefix .Destination "http") }}
    {{ $img_destination = (print .Page.Site.Params.COSUrl.Host (path.Join .Page.RelPermalink .Destination)) }}
    {{ end }}
{{- end -}}

<img alt="{{ $.Text }}" src="{{ $img_destination | safeURL }}" />